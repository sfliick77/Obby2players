  <!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Mini Obby 3D - 2 Jogadores</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
    #overlay {
      position: absolute;
      top:0; left:0;
      width:100%; height:100%;
      background: rgba(0,0,0,0.8);
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      font-family: Arial, sans-serif;
      font-size: 24px;
      z-index: 10;
    }
    #info {
      position: absolute;
      top: 10px;
      left: 10px;
      color: #fff;
      font-family: Arial, sans-serif;
      font-size: 18px;
      text-shadow: 1px 1px 3px #000;
      display: none;
    }
  </style>
</head>
<body>
  <div id="overlay">
    <h1>üèÉ Mini Obby 3D - 2 Jogadores</h1>
    <p>Pressione <b>ENTER</b> para come√ßar</p>
  </div>
  <div id="info">Jogador 1: WASD + Espa√ßo | Jogador 2: Setas + Numpad 0</div>

  <!-- √Åudio de fundo (playlist ser√° controlada via JS) -->
  <audio id="bg-music" preload="auto"></audio>

  <audio id="death-sound">
    <source src="https://github.com/sfliick77/Roblox-off-sound/raw/main/Roblox%20Death%20Sound%20-%20OOF%20_%20Sound%20Effect%20HD%20-%20HomeMadeSoundEffects(MP3_160K).mp3" type="audio/mpeg">
  </audio>

  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
  <script>
    // --- Vari√°veis ---
    let gameStarted = false;
    let gameOver = false;

    const overlay = document.getElementById('overlay');
    const info = document.getElementById('info');
    const bgMusic = document.getElementById("bg-music");
    const deathSound = document.getElementById("death-sound");

    // --- Playlist ---
    const playlist = [
      "https://github.com/sfliick77/M-sica-de-fundo/raw/main/Envici%20November%20-%20Original%20Instrument(MP3_160K).mp3",
      "https://github.com/sfliick77/Relaxed-scene/raw/main/Relaxed%20Scene(MP3_160K).mp3"
    ];
    let currentTrack = 0;

    function playMusic() {
      bgMusic.src = playlist[currentTrack];
      bgMusic.volume = 0.3;
      bgMusic.play();
    }

    bgMusic.addEventListener("ended", () => {
      currentTrack = (currentTrack + 1) % playlist.length;
      playMusic();
    });

    // --- Teclas ---
    const keys = {};
    window.addEventListener('keydown', e => {
      keys[e.key.toLowerCase()] = true;

      if(!gameStarted && !gameOver && e.key === "Enter"){
        gameStarted = true;
        overlay.style.display = "none";
        info.style.display = "block";
        if(bgMusic.paused){ playMusic(); }
      }

      if(gameOver && e.key === "Enter"){
        restartGame();
      }
    });
    window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

    // --- Cena ---
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 2000);
    const renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Fundo
    const loader = new THREE.TextureLoader();
    loader.load(
      'https://raw.githubusercontent.com/sfliick77/Background-c-u/main/277fba7bc86484d9f6cf37c87ee44de2.jpg',
      texture => scene.background = texture
    );

    // Luz
    const light = new THREE.DirectionalLight(0xffffff, 1);
    light.position.set(5,10,7);
    scene.add(light);
    scene.add(new THREE.AmbientLight(0xffffff, 0.4));

    // Jogadores
    function createPlayer(color, x){
      const geo = new THREE.BoxGeometry(1,1,1);
      const mat = new THREE.MeshStandardMaterial({color});
      const mesh = new THREE.Mesh(geo,mat);
      mesh.position.set(x,1,0);
      scene.add(mesh);
      return mesh;
    }

    const player1 = createPlayer(0xff5555, -2); // vermelho
    const player2 = createPlayer(0x5555ff,  2); // azul

    const players = [
      { mesh: player1, velocity: new THREE.Vector3(), canJump: false, controls: {left:"a", right:"d", forward:"w", back:"s", jump:" "} },
      { mesh: player2, velocity: new THREE.Vector3(), canJump: false, controls: {left:"arrowleft", right:"arrowright", forward:"arrowup", back:"arrowdown", jump:"0"} } // Numpad 0
    ];

    // Plataformas
    const platforms = [];
    function createPlatform(x,y,z,width=4,depth=4,color=0x00ff00){
      const geo = new THREE.BoxGeometry(width,0.5,depth);
      const mat = new THREE.MeshStandardMaterial({color});
      const plat = new THREE.Mesh(geo,mat);
      plat.position.set(x,y,z);
      scene.add(plat);
      platforms.push(plat);
    }
    for(let i=0; i<30; i++){
      const x = (Math.random()*6)-3;
      const y = i*1.5;
      const z = -i*5;
      const color = new THREE.Color(`hsl(${i*12},80%,50%)`).getHex();
      createPlatform(x,y,z,4,4,color);
    }

    // F√≠sicas
    const gravity = -0.05;
    const speed = 0.16;

    camera.position.set(0,8,15);

    function restartGame(){
      gameOver = false;
      gameStarted = true;
      overlay.style.display = "none";
      info.style.display = "block";

      player1.position.set(-2,1,0);
      player2.position.set( 2,1,0);
      players.forEach(p => p.velocity.set(0,0,0));
    }

    // Loop
    function animate(){
      requestAnimationFrame(animate);
      if(gameStarted && !gameOver){
        players.forEach(p=>{
          const {mesh, velocity, controls} = p;
          let moveX=0, moveZ=0;
          if(keys[controls.left]) moveX -= 1;
          if(keys[controls.right]) moveX += 1;
          if(keys[controls.forward]) moveZ -= 1;
          if(keys[controls.back]) moveZ += 1;

          if(moveX!==0||moveZ!==0){
            const len = Math.sqrt(moveX*moveX+moveZ*moveZ);
            mesh.position.x += (moveX/len)*speed;
            mesh.position.z += (moveZ/len)*speed;
          }

          velocity.y += gravity;
          mesh.position.y += velocity.y;
          p.canJump = false;

          platforms.forEach(plat=>{
            const px=plat.position.x, py=plat.position.y, pz=plat.position.z;
            if(mesh.position.x > px-2 && mesh.position.x < px+2 &&
               mesh.position.z > pz-2 && mesh.position.z < pz+2 &&
               mesh.position.y > py && mesh.position.y < py+0.5){
              mesh.position.y = py+1;
              velocity.y=0;
              p.canJump=true;
            }
          });

          if(keys[controls.jump] && p.canJump){
            velocity.y=0.8;
          }

          if(mesh.position.y < -2){
            gameOver = true;
            gameStarted = false;
            overlay.style.display = "flex";
            overlay.innerHTML = `<h1>üíÄ Game Over!</h1><p>Pressione <b>ENTER</b> para reiniciar</p>`;
            deathSound.play();
          }
        });

        // C√¢mera m√©dia dos 2 jogadores
        const midX = (player1.position.x+player2.position.x)/2;
        const midY = (player1.position.y+player2.position.y)/2;
        const midZ = (player1.position.z+player2.position.z)/2;
        camera.position.set(midX, midY+6, midZ+12);
        camera.lookAt(midX, midY, midZ);
      }

      renderer.render(scene,camera);
    }
    animate();
  </script>
</body>
</html>
